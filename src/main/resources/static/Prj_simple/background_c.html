<style>
  /* *{
    font-family: 'Merriweather', serif;
    font-family: 'Roboto Condensed', sans-serif;
  } */
  .center-content {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    .table-sm {
      font-size: 16px; /* Reduce font size */
    }

    .table-sm th,
    .table-sm tr td{
      vertical-align: middle;
      align-items: center;
      justify-content: center;
      padding: 0.1rem; /* Reduce padding */
    }

    .btn-link {
      transition: transform 0.3s ease;
    }

    .btn-link:hover {
      transform: scale(1.1);
    }


    @keyframes fadeInRow {
      0% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }
    
    /* Apply the animation to the table rows */
    .table-fade-in {
      animation: fadeInRow 0.5s ease-in-out;
    }





    /* Loading Spinner Overlay Start*/
    .loading-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black background */
      z-index: 9998; /* Ensure it's behind the loading screen but above the main content */
    }
    
    .loading-screen {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #fff;
      padding: 20px;
      border-radius: 5px;
      font-size: large;
    }
    
    .loading-spinner {
      border: 8px solid #f3f3f3; /* Increase the border width */
      border-top: 8px solid #3498db; /* Increase the border width */
      border-radius: 50%;
      width: 60px; /* Increase the width */
      height: 60px; /* Increase the height to maintain a circular shape */
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    #main-content {
      display: relative; /* Hide main content until API responds */
    }
    
    #main-content.loading {
      /* Styles for dimming the main content */
      pointer-events: none; /* Allow clicks to pass through the loading overlay */
      opacity: 0.5; /* Dim the main content */
    }

    /*Loading Spinner Overlay End*/

    .floating-div {
      position: fixed;
      top: 15%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      max-width: 900px;
    }

    .shake-invalid {
      animation: shake 0.5s;
    }
    
    @keyframes shake {
      0%, 100% {
        transform: translateX(0);
      }
      10%, 30%, 50%, 70%, 90% {
        transform: translateX(-10px);
      }
      20%, 40%, 60%, 80% {
        transform: translateX(10px);
      }
    }


    .card {
    margin-bottom: 15px;
}

.icon-action {
    margin-top: 5px;
    float: right;
    font-size: 80%;
}

.list-group-item .title {
    margin-top: 5px;
    margin-bottom: 12px;
    font-weight: 600;
}

.gray-border-style{
    border-radius: 5px; 
    border: 2px solid rgba(206, 206, 206, 0.54);
}

.blk{
  width: 100%;
  display: contents;
}
</style>



  <!-- spinner overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-screen">
        <div class="loading-spinner"></div>
        <p>Loading...</p>
      </div>
  </div>

  <div id="main-content" class="container mt-5">
    <div class="row floating-div">
      <div class="col">
        <div class="alert-container"></div>
      </div>
    </div>
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link active" data-toggle="tab" href="#student-details">Student Details</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#assignments">Assignments</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#tests">Tests</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#notes">Notes</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#reports">Reports</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#other">Other</a>
      </li>
    </ul>

    
    <div class="tab-content mt-4">
      <!-- Student Details Tab Content -->
      <div id="student-details" class="tab-pane fade show active">
        <h3>Student Details</h3>
        <div class="alert alert-success" id="success-alert3">
          <button type="button" class="close" data-dismiss="alert">x</button>
          <strong>Message!</strong>
          No student details found!
       </div>
       <!-- <div class="alert alert-danger" id="success-dange3">
        <button type="button" class="close" data-dismiss="alert">x</button>
        <strong>Message!</strong>
        No student details found!
     </div> -->
       
        <!-- Input Group for Roll Number -->
        <form class="form-inline">    
            <div class="form-group">
                <label for="rollno" class="form-check-label mr-2">Search here: </label>
                <input type="text" class="form-control" id="rollno" placeholder="Enter your roll number">
            </div>
            <div class="form-group mx-2">
                <button type="button" class="btn btn-primary" id="btnGetStudentDetails">Submit</button>
            </div>
            <div class="form-group mx-2">
              <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#addMentorModal" id="assignMentorBtn">Assign Mentor</button>
          </div>
          <div class="form-group mx-2">
            <button type="button" class="btn btn-info" id="getAllStudentsBtn">Get All Students</button>
        </div>
        </form>
        <div class="modal fade" id="addMentorModal" tabindex="-1" role="dialog" 
                aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="addAssignmentModalLabel">Assign Mentor</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <div class="form-row">
                        <div class="form-group col-md-6">
                          <label for="rollno">Roll No</label>
                          <input type="text" class="form-control" id="rollnoForMentorShip" placeholder="Enter rollno">
                        </div>
                        <div class="form-group col-md-6">
                          <label for="code">Mentor Name</label>
                          <input type="text" class="form-control" id="mentorname" placeholder="Enter mentor name">
                        </div>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                      <button type="button" id="submitMentorBtn" class="btn btn-primary">Submit</button>
                    </div>
                  </div>
                </div>
              </div>
        <br>
        <div class="alert alert-danger" id="success-alert">
          <button type="button" class="close" data-dismiss="alert">x</button>
          <strong>Message!</strong>
          No student details found!
       </div>
        <div class="studentDetailsClz">
          <table class="table" id="studentDetailsTbl">
            <thead>
              <tr>
                <th scope="col">Roll No</th>
                <th scope="col">Fullname</th>
                <th scope="col">Contact No</th>
                <th scope="col">Enrollment No</th>
                <th scope="col">Semester</th>
                <th scope="col">Email</th>
                <th scope="col">PreviousSemResult</th>
                <th scope="col">Is Project Leader</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody>
            <!-- <tr>
              <th scope="row">1</th>
              <td>John Doe</td>
              <td>123-456-7890</td>
              <td>12345</td>
              <td>1</td>
              <td>Computer Science</td>
              <td>A</td>
            </tr> -->
            <!-- Add more rows as needed -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Assignments Tab Content -->
      <div id="assignments" class="tab-pane fade">
        <h3>Assignments</h3>
        <div class="row mt-1 mb-1">
          <div class="col">
            <div class="alert alert-success" id="success-alert2">
                <button type="button" class="close" data-dismiss="alert">x</button>
                <strong>Assignment Update Information!</strong>
                Assignments have been updated in student details.
              </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            
            <!-- Add Assignment Button -->
            <div class="row mb-3">
              <div class="col-md-5">
                <button id="addAssignmentBtn" class="btn btn-primary float-right"><i class="fa fa-plus-circle mr-2"></i>Add Assignment</button>
              </div>
              <div class="col-md-7">
                <button id="viewAssignmentBtn" class="btn btn-primary float-right"><i class="fa fa-eye mr-2"></i>View Assignment</button>
              </div>
              <div class="col-md my-2">
                <button id="applyAssigntoNewStuds" class="btn btn-link float-right">Apply assignments to newly added students</button>
              </div>
            </div>
    
            <!-- Bootstrap Form for Adding Assignment -->
            <div class="row">
              <div class="col-md-5">
                <form>
                  <div class="form-group">
                    <label for="assignment-title">Assignment Title</label>
                    <input type="text" class="form-control" id="assignment-title" placeholder="Enter assignment title">
                  </div>
                  <div class="form-group">
                    <label for="question">Question</label>
                    <textarea class="form-control" id="question" rows="4" placeholder="Enter assignment question"></textarea>
                  </div>
                  <button type="button" id="questionsSubmitBtn" data-toggle="modal" data-target="#addAssignmentModal" class="btn btn-primary">Submit Assignment</button>
                </form>
              </div>
    
              <!-- <div class="row mb-3">
                <div class="col">
                  <button class="btn btn-primary" data-toggle="modal" data-target="#addAssignmentModal">Add Assignment</button>
                </div>
              </div> -->
      
              <!-- Bootstrap Modal for Adding Assignment -->
              <div class="modal fade" id="addAssignmentModal" tabindex="-1" role="dialog" aria-labelledby="addAssignmentModalLabel"
                aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="addAssignmentModalLabel">Submit Assignment</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <div class="form-row">
                        <div class="form-group col-md-6">
                          <label for="branch">Branch</label>
                          <input type="text" class="form-control" id="branch" placeholder="Enter branch">
                        </div>
                        <div class="form-group col-md-6">
                          <label for="semester">Semester</label>
                          <input type="text" class="form-control" id="semester" placeholder="Enter semester">
                        </div>
                        <div class="form-group col-md-6">
                          <label for="code">Code</label>
                          <input type="text" class="form-control" id="code" placeholder="Enter code">
                        </div>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                      <button type="button" id="submitAssignment" class="btn btn-primary">Submit</button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-7">
                <div class="studentDetailsClz1">
                  <table class="table table-sm table-striped" id="viewAssignmentTbl">
                    <thead>
                      <tr>
                        <th scope="col">Sr No</th>
                        <th scope="col">Assignments</th>
                        <th scope="col">Action</th>
                      </tr>
                    </thead>
                    <tbody>
                    <!-- Add more rows as needed -->
                    </tbody>
                  </table>
                </div>
                <div class="container mt-5">
                  <div class="text-center d-none" id="spinnerContainer">
                    <div class="spinner-border text-primary" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                  </div>
                  <div class="text-center d-none" id="contentContainer">
                    <!-- Content will be replaced here -->
                  </div>
                </div>
              </div>
              
              <div class="modal fade" id="myModal" data-backdrop="static">
                <div class="modal-dialog modal-xl">
                  <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header">
                      <h4 class="modal-title">Student Assignment Information</h4>
                      <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
              
                    <!-- Modal Body -->
                    <div class="modal-body">
                      <div class="form-group">
                        <label for="assignmentCodeDropdwn">Assignment Code</label>
                        <select name="assignmentCodeDropdwn" id="assignmentCodeDropdwn" class="form-control">
                          <option value="0">--SELECT--</option>
                        </select>
                      </div>
                      <!-- Bootstrap table -->
                      <table id="submittedAssignmentsTbl" class="table table-bordered table-sm">
                        <thead>
                          <tr>
                            <th>Roll No</th>
                            <th>Full Name</th>
                            <th>Code</th>
                            <th>Assignment Status</th>
                            <th>Attachments</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>1</td>
                            <td>John Doe</td>
                            <td>5th</td>
                            <td>file1.pdf</td>
                          </tr>
                          <tr>
                            <td>2</td>
                            <td>Jane Smith</td>
                            <td>3rd</td>
                            <td>file2.docx</td>
                          </tr>
                          <!-- Add more rows as needed -->
                        </tbody>
                      </table>
                    </div>
              
                    <!-- Modal Footer -->
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
        <div class="row mt-4">
          <div class="col">
            <ul id="questionOlList" class="d-flex" style="flex-wrap: wrap;justify-content: flex-start;">
              
            </ul>
          </div>
        </div>
        
        <!-- End of Bootstrap Form -->
        <!-- Your content for Assignments tab goes here -->
        <!-- Add more content as needed -->
      </div>

      <!-- Tests Tab Content -->
      <div id="tests" class="tab-pane fade">
        <h3>Tests</h3>
        <!-- Your content for Tests tab goes here -->
        <form id="tests-form" class="form-inline">

          <!-- Roll Number Input -->
          <div class="form-group mb-2">
            <label for="rollnotest" class="sr-only">Roll Number</label>
            <input type="text" class="form-control" id="rollnotest" name="rollnotest" placeholder="Enter Roll Number">
          </div>
      
          <!-- Subject Dropdown -->
          <div class="form-group mx-sm-3 mb-2">
            <label for="subject" class="sr-only">Subject</label>
            <select class="form-control" id="subject" name="subject">
              <option value="0">--SELECT--</option>
              <option value="OOP">OOP</option>
              <option value="AJP">AJP</option>
              <option value="STE">STE</option>
              <!-- Add more options if needed -->
            </select>
          </div>
      
          <!-- Test Dropdown -->
          <div class="form-group mx-sm-3 mb-2">
            <label for="test" class="sr-only">Test</label>
            <select class="form-control" id="test" name="test">
              <option value="0">--SELECT--</option>
              <option value="unitTest1">Unit Test 1</option>
              <option value="unitTest2">Unit Test 2</option>
              <!-- Add more options if needed -->
            </select>
          </div>
      
          <!-- Marks Input -->
          <div class="form-group mx-sm-3 mb-2">
            <label for="marks" class="sr-only">Marks</label>
            <input type="text" class="form-control" id="marks" name="marks" placeholder="Enter Marks">
          </div>
      
          <!-- Submit Button -->
          <button type="button" id="addMarksBtn" class="btn btn-primary mb-2 mr-3">Add Marks</button>
          <button type="button" id="updateMarksJson" class="btn btn-outline-success mb-2">Submit Result</button>

          <div class="alert alert-success" id="success-alert1">
            <button type="button" class="close" data-dismiss="alert">x</button>
            <strong>Message Update Information!</strong>
            Marks have been updated in student details.
         </div>
         <div class="alert alert-warning" id="warning-alert">
          <button type="button" class="close" data-dismiss="alert">x</button>
          <strong>Message Update Information!</strong>
          No Data found to update in student details.
       </div>
        </form>

        <div class="row">
          <div class="col">
            <p class="marksAddedJson"></p>
            
          </div>
        </div>

        <div class="row">
          <div class="col table-responsive" style="height:500px;">
            <table id="marksAddedtbl" class="table table-sm table-striped table-fade-in">
              <thead>
                <tr>
                  <th>Roll No</th>
                  <th>Subject</th>
                  <th>Test</th>
                  <th>Marks</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>

              </tbody>
            </table>
          </div>
        </div>

      </div>

      <!-- Notes Tab Content -->
      <div id="notes" class="tab-pane fade">
        <h3>Notes</h3>
        
        <!-- Your content for Notes tab goes here -->
        <div class="row">
          <div id="my-alert" class="alert alert-danger hidden" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">    
                <span aria-hidden="true">&times;</span>
            </button> 
            <strong>Error:</strong> Failed to processing data from the API. Please try again later.
          </div>
        </div>
        <div class="row">
          <div class="col">
            <form class="form-inline">

              <!-- Roll Number Input -->
              <!-- <div class="form-group mb-2 mr-2">
                <label for="noteFile" class="sr-only">Choose File</label>
                <input type="file" class="form-control" id="noteFile" name="fileChoose" placeholder="" multiple="multiple">
              </div> -->
          
              <!-- Submit Button -->
              <button type="button" id="uploadNotes" class="btn btn-primary mb-2 mr-3">Upload Notes</button><br>
              <button type="button" id="getNotes" class="btn btn-primary mb-2 mr-3">Get Notes</button>

              
            
              
            </form>
          </div>
        </div>
        <div class="row">
          <div class="col"></div>
        </div>
        <div class="row">
          <div class="col">
            <div class="notesDetailsClz">
              <table class="table table-sm table-striped table-fade-in" id="notesDetailsTbl">
                <thead>
                  <tr>
                    <th scope="col">Sr No</th>
                    <th scope="col">Branch</th>
                    <th scope="col">Semester</th>
                    <th scope="col">Subject</th>
                    <th scope="col">File Name</th>
                    <th scope="col">Notes</th>
                    <th scope="col">Delete</th>
                  </tr>
                </thead>
                <tbody>
                  
                <!-- Add more rows as needed -->
                </tbody>
              </table>
              <div class="text-center mt-3" id="loadingSpinner" style="display: none;">
                <div class="spinner-border text-primary" role="status">
                  <span class="sr-only">Loading...</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <nav aria-label="Page navigation">
              <ul class="pagination justify-content-center" id="pagination">
                  <!-- JavaScript will populate this section -->
              </ul>
            </nav>
          </div>
        </div>
        <div class="row">
          <div class="modal fade" id="myModal2">
            <div class="modal-dialog modal-xl">
              <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                  <h4 class="modal-title">Student Information</h4>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
          
                <!-- Modal Body -->
                <div class="modal-body">
                  <!-- Bootstrap table -->
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="semTxt">Semester</label>
                        <input type="text" class="form-control" id="semTxt" placeholder="Enter semester" />
                      </div>
                      
                      
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="subject">Subject</label>
                        <input type="text" class="form-control" id="subjectTxt" placeholder="Enter subject" />
                      </div>
                      
                      
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="notesFile">File</label>
                        <input type="file" class="form-control" id="notesFile" />
                      </div>
                      
                      
                    </div>
                    
                  </div>
                  <div class="row">
                    <div class="col">

                      <div class="form-group">
                        <button type="button" class="btn btn-primary" id="btnUpload">Upload</button>
                      </div>
                    </div>
                  </div>
                </div>
          
                <!-- Modal Footer -->
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>


      <!--Reports Tab  -->
      <div id="reports" class="tab-pane fade">
        <h3>Reports</h3>
        
        <!-- Your content for Notes tab goes here -->
        <div class="row">
          <div class="col">
            <form class="form-inline" style="justify-content: space-between;">
              <input type="text" class="form-control" id="rollnoAttendance" placeholder="Enter rollno" />
              <select name="months" id="months" class="form-control">
                <option value="0">--SELECT--</option>
                <option value="1">January</option>
                <option value="2">February</option>
                <option value="3">March</option>
                <option value="4">April</option>
                <option value="5">May</option>
                <option value="6">June</option>
                <option value="7">July</option>
                <option value="8">August</option>
                <option value="9">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
                <option value="13">Winter 23</option>
              </select>
              <select name="subjects" id="subjects" class="form-control">
                <option value="0">--SELECT--</option>
                <option value="OOP">OOP</option>
                <option value="STE">STE</option>
                <option value="AJP">AJP</option>
              </select>
              <input type="text" class="form-control calAttendance" id="lecturesAttended" placeholder="Enter lectures attended count" />
              <input type="text" class="form-control calAttendance" id="totalLectures" placeholder="Enter total lectures count" />
              <input type="text" class="form-control" id="presentyPercent" placeholder="Attendance %" readonly disabled />
              <button type="button" id="submitAttendance" class="btn btn-outline-dark mb-2">Submit</button>
              <button type="button" id="getAttendanceList" class="btn btn-warning mb-2">Attendance List</button>
              <button type="button" id="toggleTable" data-toggle="collapse" data-target=".attendanceTblClz" class="btn btn-link mb-2">Show/Hide Table</button>
            </form>
          </div>
        </div>
        <div class="row">
          <div class="col"></div>
        </div>
        <div class="row">
          <div class="col">
            <div class="attendanceTblClz collapse">
              <table class="table table-sm table-striped table-fade-in text-center " id="attendanceTbl">
                <thead>
                  <tr>
                    <th scope="col">Roll No</th>
                    <th scope="col">Month</th>
                    <th scope="col">Subject</th>
                    <th scope="col">Lectures Attended</th>
                    <th scope="col">Total Lectures</th>
                    <th scope="col">Attendance Percent</th>
                    <th scope="col">Action</th>
                  </tr>
                </thead>
                <tbody>
                  
                <!-- Add more rows as needed -->
                </tbody>
              </table>
              <div class="text-center mt-3" id="loadingSpinner" style="display: none;">
                <div class="spinner-border text-primary" role="status">
                  <span class="sr-only">Loading...</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <nav aria-label="Page navigation">
              <ul class="pagination justify-content-center" id="pagination">
                  <!-- JavaScript will populate this section -->
              </ul>
            </nav>
          </div>
        </div>
        <div class="row">
          <div class="modal fade" id="myModal2">
            <div class="modal-dialog modal-xl">
              <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                  <h4 class="modal-title">Student Information</h4>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
          
                <!-- Modal Body -->
                <div class="modal-body">
                  <!-- Bootstrap table -->
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="semTxt">Semester</label>
                        <input type="text" class="form-control" id="semTxt" placeholder="Enter semester" />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="subject">Subject</label>
                        <input type="text" class="form-control" id="subjectTxt" placeholder="Enter subject" />
                      </div>
                      
                      
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="notesFile">File</label>
                        <input type="file" class="form-control" id="notesFile" />
                      </div>
                      
                      
                    </div>
                    
                  </div>
                  <div class="row">
                    <div class="col">

                      <div class="form-group">
                        <button type="button" class="btn btn-primary" id="btnUpload">Upload</button>
                      </div>
                    </div>
                  </div>
                </div>
          
                <!-- Modal Footer -->
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
        </div>


        <div class="row">
          <div class="col">
            <div class="mainCont">
              <div class="card-container">
                
              </div>
            </div>
          </div>
        </div>

      </div>


      <div id="other" class="tab-pane fade">
        <h3>Other</h3>
        
        <div class="row">
          <div class="col">
            <button id="backupBtn" type="button" class="btn btn-info">Backup</button>
          </div>
        </div>
    </div>



      </div>



    </div>
  </div>


<script>
    
      
      function showAlert(message, type, timeout) {
        const alertContainer = $('.alert-container');
        const alertDiv = $(`<div class="alert alert-${type} alert-dismissible fade show" style="font-weight: bold;">${message} <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>`);
        alertContainer.append(alertDiv);
      
        // Show the alert with fade-in animation
        alertDiv.fadeIn('slow');
      
        // Hide the alert after 3 seconds with fade-out animation
        setTimeout(function() {
          alertDiv.fadeOut('slow', function() {
            $(this).remove();
          });
        }, 4000);
      }

      function showLoadingSpinner() {
        document.getElementById('loadingSpinner').style.display = 'block';
      }
      
      // Function to hide loading spinner
      function hideLoadingSpinner() {
        document.getElementById('loadingSpinner').style.display = 'none';
      }
      var list = [];
      $("#success-alert").hide();
      $("#success-alert1").hide();
      $("#success-alert2").hide();
      $("#success-alert3").hide();
      $("#success-dange3").hide();
      
      $("#warning-alert").hide();
      $("#my-alert").hide();

        $('#btnGetStudentDetails').click(function getStudent() {
            getStudentDetails();
        })

        $('#submitAssignment').click(function() {
            submitAssignment();
        })


        $('#questionsSubmitBtn').click(function() {
            submitAllQuestions();
        })


        $('#viewAssignmentBtn').click(function() {

          

            viewAssignments();
        })
        
        $('#addMarksBtn').click(function() {
            addMarksToJson();
        })

        $('#updateMarksJson').click(function() {
          updateMarksJson();
        })
        
        $('#uploadNotes').click(function() {
          $('#myModal2').modal();
          
        })

        $('#btnUpload').click(function() {
          
          uploadNotes();
        })


        $('#getNotes').click(function() {
          getAllNotes(0);
          //getNotes();
        })

        $('#applyAssigntoNewStuds').click(function() {
          updateAssignmentToNewlyAddedStudents();
        })


        function showSpinnerOverlay(){
            $(".loading-overlay").fadeIn();
            $(".loading-screen").fadeIn();
            $("#main-content").addClass("loading");
            //$("#main-content").fadeOut();
        }

        function hideSpinnerOverlay(){
            $(".loading-screen").fadeOut();
            //$("#main-content").fadeIn();
            $("#main-content").removeClass("loading");
            $(".loading-overlay").fadeOut();
        }

        $('#submitMentorBtn').click(function(){
          submitMentor();
        })

        $('#getAllStudentsBtn').click(function(){
          getAllStudents();
        })


        $('#rollnotest').blur(function(){
          showSpinnerOverlay();
          fetchStudentMarksByRollNo();
          hideSpinnerOverlay();
        });

        $('#submitAttendance').click(function(){
          submitAttendance();
        })

        $('#backupBtn').click(function(){
          createDataBackup();
        })

        function createDataBackup(){
          showSpinnerOverlay();
          var apiUrl = 'http://localhost:8081/createDataBackup';
            fetch(apiUrl, {
            method: 'GET',
          })
          .then(response => {
            hideSpinnerOverlay();
            if (!response.ok) {
              throw new Error('Network response was not ok.');
            }
            return response.blob();
          })
          .then(blob => {
            hideSpinnerOverlay();
            showAlert('Data backed up successfully', 'success');
            // Create a download link and set its attributes
            const downloadLink = document.createElement('a');
            downloadLink.href = URL.createObjectURL(blob);
            
            // Replace 'filename.ext' with the desired name of the downloaded file
            var originalDateTime = new Date();
            var modifiedDateTimeStr = formatDate(originalDateTime);
            function formatDate(dateTime) {
              var year = dateTime.getFullYear();
              var month = String(dateTime.getMonth() + 1).padStart(2, '0');
              var day = String(dateTime.getDate()).padStart(2, '0');
              var hours = String(dateTime.getHours()).padStart(2, '0');
              var minutes = String(dateTime.getMinutes()).padStart(2, '0');
              var seconds = String(dateTime.getSeconds()).padStart(2, '0');

              // Modify the format as needed (e.g., "YYYY-MM-DD HH:mm:ss")
              return year + '' + month + '' + day + '' + hours + '' + minutes + '' + seconds;
            }

            downloadLink.download = 'filename_'+modifiedDateTimeStr+'.txt';


            // Append the link to the document
            document.body.appendChild(downloadLink);

            // Simulate a click on the link to trigger the download
            downloadLink.click();

            // Remove the link from the document after the download is triggered
            document.body.removeChild(downloadLink);
          })
          .catch(error => {
              hideSpinnerOverlay();
              alert("error " + error);
          });





        }

        $('#rollno').keyup(function(){

          var rnumber = $('#rollno').val();

          $('#studentDetailsTbl> tbody > tr').filter(function() {      
            $(this).toggle($(this).text().toLowerCase().indexOf(rnumber) > -1)
          });

        })

        

        $('#rollnoAttendance').keyup(function(){

        var rnumber = $('#rollnoAttendance').val();

        $('#attendanceTbl> tbody > tr').filter(function() {      
          $(this).toggle($(this).text().toLowerCase().indexOf(rnumber) > -1)
        });

        })

        $('#getAttendanceList').click(function(){
          getAttendanceList();
          asd();
        });

        function asd(){
          $.ajax({
              type: 'GET',
              url: 'http://localhost:8081/asd',
              contentType: 'application/json',
              success: function(dataArr){
                // $('.mainCont').html('');
                $('.card-container').html('');
                $('.card').remove()
                hideSpinnerOverlay();
                var mCounter=0;
                var subCOunter=0;
                dataArr.forEach(jTestData => {
                  
                  // rollno
                  // fullname
                  // attendanceEntity


                  //create map na
                  var masterObj = new Object();
                  var dataFinal = [];
                  var rollno = jTestData.rollno;
                  var fullname = jTestData.fullname;
                  var attendanceList = jTestData.attendanceEntity;

                  if(attendanceList.length==0){
                    return;
                  }
                  
                  var oopArr = [];
                  var steArr = [];
                  var ajpArr=[];
                  var overallPerc = 0.0;
                  attendanceList.forEach(e => {
                    if(e.subject==='OOP'){
                      oopArr.push(e);
                    }
                    if(e.subject==='AJP'){
                      ajpArr.push(e);
                    }
                    if(e.subject==='STE'){
                      steArr.push(e);
                    }
                  })
                  var obj = {};
                  obj['OOP'] = oopArr;
                  obj['AJP'] = ajpArr;
                  obj['STE'] = steArr;
                  

                  masterObj['rollno'] = rollno
                  masterObj['fullname'] = fullname
                  masterObj['subjects'] = new Array();
                  var oopObj = {};
                  oopObj['OOP'] = oopArr;
                  var steObj = {};
                  steObj['STE'] = steArr;
                  var ajpObj = {};
                  ajpObj['AJP'] = ajpArr;
                  oopArr=[];
                  steArr=[];
                  ajpArr=[];
                  masterObj['subjects'].push(oopObj);
                  masterObj['subjects'].push(steObj);
                  
                  masterObj['subjects'].push(ajpObj);
                  // console.log(masterObj);
                  var counter =0;
                  var subjectAttendanceCount = 0;
                  var sumSubPercent=0.0;
                  var sumGrandSubPercent=0.0;
                  // $('.card'+counter).find('#subList').html('');
                  masterObj['subjects'].forEach(at => {
                    if(at[Object.keys(at).find(key => at[key])].length==0){
                      return;
                    }
                  var cardHtml = `<!-- card subject -->
                    <div class="blk">
                      <div class="col-md-4">
                          <div class="card card${subCOunter}">
                              <header class="card-header">
                                  <a href="#" data-toggle="collapse" data-target="#collapse1_${subCOunter}" aria-expanded="false"
                                      style="text-decoration: none;">
                                      <i class="icon-action fa fa-chevron-down"></i>
                                      <span class="title">${Object.keys(at).find(key => at[key])}<strong class="mx-2"></strong></span>
                                      <span class="sub_${Object.keys(at).find(key => at[key])}${mCounter} float-right mr-3"> </span>
                                  </a>
                              </header>
                              <div class="collapse" id="collapse1_${subCOunter}">
                                  <article class="card-body">
                                      <div class="table-responsive">
                                        <div id="subList"></div>
                                      </div>
                                  </article> <!-- card-body.// -->
                              </div> <!-- collapse .// -->
                          </div> <!-- card.// -->
                      </div>
                    </div>`;

                    $('.card-container').append(cardHtml);
                    


                    var subList = '';
                    var subCount=0;
                    at[Object.keys(at).find(key => at[key])].forEach(i => {
                      
                      var monthStr = i.month;
                      var monthMap = {
                          1: "January",
                          2: "February",
                          3: "March",
                          4: "April",
                          5: "May",
                          6: "June",
                          7: "July",
                          8: "August",
                          9: "September",
                          10: "October",
                          11: "November",
                          12: "December"
                      };
                      subList = `<div class="card-header mb-2 gray-border-style">
                                            <strong>${monthMap[i.month]}</strong> ${i.lecturesAttended} of ${i.totalLectures} <strong><span class="float-right">${i.attendancePercent}%</span> </strong>
                                        </div>`;
                      $('.card'+subCOunter).find('#subList').append(subList);
                      subjectAttendanceCount++;
                      sumSubPercent += i.attendancePercent;
                      sumGrandSubPercent += i.attendancePercent;
                      subList = '';
                      subCount++;
                    })
                    
                    overallPerc=(sumSubPercent/subjectAttendanceCount).toFixed(2);
                    counter++;
                    subCOunter++;
                    
                    $('.sub_'+Object.keys(at).find(key => at[key])+mCounter).text(Number(sumGrandSubPercent/subCount).toFixed(2)+' %');
                    sumGrandSubPercent =0.00;
                  })

                  var mainStrip = `<!-- card main strip-->
                    <div class="card">
                        <header class="card-header">
                            <a href="#" data-toggle="collapse" data-target="#collapse1${mCounter}" aria-expanded="false"
                                style="text-decoration: none;">
                                <i class="icon-action fa fa-chevron-down"></i>
                                <span class="title">RollNo (${jTestData.rollno})<strong class="mx-2">${jTestData.fullname}</strong></span>
                                <span class="title float-right mr-3">Overall Attendance (${overallPerc}%) </span>
                            </a>
                        </header>
                        <div class="collapse" id="collapse1${mCounter}">
                            <article class="card-body">
                                <div class="d-flex align-items-start flex-wrap">
                                  ${$('.card-container').html()}
                                </div>

                            </article> <!-- card-body.// -->
                        </div> <!-- collapse .// -->
                    </div> <!-- card.// -->` 


                  $('.mainCont').append(mainStrip);
                  $('.card-container').html('');
                  mCounter++;
                  // $('#attendanceTbl>tbody').append('<tr id="'+jTestData.attendanceDetailsId+'"><td id="rollno" data-idno="'+jTestData.attendanceDetailsId+'" data-value="'+jTestData.rollno+'">'+jTestData.rollno+'</td> <td id="month" data-value="'+jTestData.month+'">'+jTestData.month+'</td> <td id="subject" data-value="'+jTestData.subject+'">'+jTestData.subject+'</td> <td id="lecturesAttended" data-value="'+jTestData.lecturesAttended+'">'+jTestData.lecturesAttended+'</td><td id="totalLectures" data-value="'+jTestData.totalLectures+'">'+jTestData.totalLectures+'</td><td id="attendancePercent" data-value="'+jTestData.attendancePercent+'">'+jTestData.attendancePercent+'</td><td>'+submitBtnHtml+' '+ediBtnHtml+' '+closeBtnHtml+'</td></tr>');
                })

              },
              error: function(err){
                hideSpinnerOverlay();
                alert("error " + error);
              }
            })
        }

        function getAttendanceList(){
          $.ajax({
              type: 'GET',
              url: 'http://localhost:8081/getAttendanceList',
              contentType: 'application/json',
              success: function(dataArr){
                hideSpinnerOverlay();
                $('#attendanceTbl>tbody').html('');
                var monthMap = {
                    1: "January",
                    2: "February",
                    3: "March",
                    4: "April",
                    5: "May",
                    6: "June",
                    7: "July",
                    8: "August",
                    9: "September",
                    10: "October",
                    11: "November",
                    12: "December"
                };
                dataArr.forEach(jTestData => {
                  var submitBtnHtml = '<button id="'+jTestData.attendanceDetailsId+'" type="button" class="submitAttendance1 mr-1 close" style="float:none!important;display:inline;"><i class="fa fa-check-circle" style="color:#37b82e; cursor:pointer;"></i></button>';

                  var ediBtnHtml = '<button id="'+jTestData.attendanceDetailsId+'" type="button" class="ediAttendance close" style="float:none!important;display:inline;"><i class="fa fa-edit" style="color:blue; cursor:pointer;"></i></button>';
                  
                  var closeBtnHtml = '<button type="button" class="delAttendance close" style="float:none!important;display:inline;"><i class="fa fa-close" style="color:red; cursor:pointer;"></i></button>';
                  
                  $('#attendanceTbl>tbody').append('<tr id="'+jTestData.attendanceDetailsId+'"><td id="rollno" data-idno="'+jTestData.attendanceDetailsId+'" data-value="'+jTestData.rollno+'">'+jTestData.rollno+'</td> <td id="month" data-value="'+jTestData.month+'">'+monthMap[jTestData.month]+'</td> <td id="subject" data-value="'+jTestData.subject+'">'+jTestData.subject+'</td> <td id="lecturesAttended" data-value="'+jTestData.lecturesAttended+'">'+jTestData.lecturesAttended+'</td><td id="totalLectures" data-value="'+jTestData.totalLectures+'">'+jTestData.totalLectures+'</td><td id="attendancePercent" data-value="'+jTestData.attendancePercent+'">'+jTestData.attendancePercent+'</td><td>'+closeBtnHtml+'</td></tr>');
                })
                // add remove listerner jquery
                deleteAttendanceTrListener();
                submitListener();
              },
              error: function(err){
                hideSpinnerOverlay();
                alert("error " + error);
              }
            })
        }

        function submitListener(){
          $('.submitAttendance1').click(function(){
            var id = $(this).attr('id');
            var eRollno = $('.edit_rollno_'+id).val();
            var eMonth = 1;
            var eSubject = $('.edit_subject_'+id).val();
            var eLecturesAttended = $('.edit_lecturesAttended_'+id).val();
            var eTotalLectures = $('.edit_totalLectures_'+id).val();
            var eAttendancePercent = $('.edit_attendancePercent_'+id).val();

            if(validateFields(id, eRollno, eMonth, eSubject, eLecturesAttended, eTotalLectures, eAttendancePercent)){
              updateAttendanceById(id, eRollno, eMonth, eSubject, eLecturesAttended, eTotalLectures, eAttendancePercent);
            } else {
              showAlert('Please provide valid input');
            }

            function validateFields(id, eRollno, eMonth, eSubject, eLecturesAttended, eTotalLectures, eAttendancePercent){
              var isValid = true;
              if($.isEmptyObject(id) || !$.isNumeric(id)){
                isValid = false;
              }
              if($.isEmptyObject(eRollno) || !$.isNumeric(eRollno)){
                isValid = false;
              }
              // if($.isEmptyObject(eMonth) || eMonth == undefined || eMonth == 0){
              //   isValid = false;
              // }
              if($.isEmptyObject(eSubject) || eSubject == undefined || eSubject == 0){
                isValid = false;
              }
              if($.isEmptyObject(eLecturesAttended) || !$.isNumeric(eLecturesAttended)){
                isValid = false;
              }
              if($.isEmptyObject(eTotalLectures) || !$.isNumeric(eTotalLectures)){
                isValid = false;
              }
              if($.isEmptyObject(eAttendancePercent) || !$.isNumeric(eAttendancePercent) || eAttendancePercent < 0.0 || eAttendancePercent> 100.0){
                isValid = false;
              }
              return isValid;
            }


            function updateAttendanceById(id, eRollno, eMonth, eSubject, eLecturesAttended, eTotalLectures, eAttendancePercent){

              var obj = new Object();
              obj['attendanceDetailsId'] = id;
              obj['rollno'] = eRollno;
              obj['month'] = eMonth;
              obj['subject'] = eSubject;
              obj['lecturesAttended'] = eLecturesAttended;
              obj['totalLectures'] = eTotalLectures;
              obj['attendancePercent'] = eAttendancePercent;
              
              $.ajax({
                  type: 'POST',
                  url: 'http://localhost:8081/saveAttendance',
                  contentType: 'application/json',
                  data: JSON.stringify(obj),
                  success: function(data){
                    $('#rollnoAttendance').val('');
                    $('#months').val('0');
                    $('#lecturesAttended').val('');
                    $('#totalLectures').val('');
                    $('#presentyPercent').val('');
                    $('#presentyPercent').attr('style', '');
                    getAttendanceList();
                    asd();
                  },
                  error: function(err){
                      alert('Error: '+err);
                  }
                })

            }

          })
        }

        function deleteAttendanceTrListener(){

          $('.ediAttendance').click(function(){
            var previousVal = $('#attendanceTbl>tbody>tr').find(':nth-child(1)')[0].innerHTML;
            var ediHtml = '<input type="text" id="rollnoAttendance" placeholder="Enter rollno">';
            var id = $(this).attr('id');
            $('#attendanceTbl>tbody>tr#'+id+'>td').each(function(i,e) {
              var attr = $(this).attr('id');

              if(attr === 'month'){
                //dropdown html

              } else if (attr === undefined){

              } else {
                var str = $(this).html(); 
                if(str.indexOf('input') == -1){
                  var ediHtml = '<input type="text" id="'+attr+'" class="edit_'+attr+'_'+id+' text-center" style="width: 20% !important;" placeholder="Enter '+attr+'" value='+str+'>';
                  $(this).html(ediHtml);
                } else {
                  $(this).html($(this).attr('data-value'));
                }
                
              }

            });

          })

          $('.delAttendance').click(function () {
            
            var attendanceId= $(this).closest('tr').attr('id');
            $.ajax({
              type: 'GET',
              url: 'http://localhost:8081/delAttendanceById?attendanceId='+attendanceId,
              contentType: 'application/json',
              success: function(data){
                //fillStudentDetailsTbl(data);
                // fetchStudentMarksByRollNo(testMarksRemoveId);
                getAttendanceList();
              },
              error: function(err){
                alert("error " + error);
              }
            })
        })
        }
        
        function submitAttendance(){

          var attendanceObj = new Object();

          var rollno = $('#rollnoAttendance').val();
          var month = $('#months option:selected').val();
          var subject = $('#subjects option:selected').val();
          var lecturesAttended = $('#lecturesAttended').val();
          var totalLectures = $('#totalLectures').val();
          var attendancePercent = $('#presentyPercent').attr('data-value');

          

          function validateAttendanceFields(rollno, month, subject, lecturesAttended, totalLectures, attendancePercent){
            var isValid = true;
            if($.isEmptyObject(rollno) || !$.isNumeric(rollno)){
              isValid = false;
            }
            if($.isEmptyObject(month) || !$.isNumeric(month) || month ==0){
              isValid = false;
            }
            if($.isEmptyObject(subject) || subject==0){
              isValid = false;
            }
            if($.isEmptyObject(lecturesAttended) || !$.isNumeric(lecturesAttended)){
              isValid = false;
            }
            if($.isEmptyObject(totalLectures) || !$.isNumeric(totalLectures)){
              isValid = false;
            }
            if($.isEmptyObject(attendancePercent) || !$.isNumeric(attendancePercent) || attendancePercent > 100.0 || attendancePercent < 0.0){
              isValid = false;
            }
            return isValid;
          }


          if(validateAttendanceFields(rollno, month, subject, lecturesAttended, totalLectures, attendancePercent)){
            
          

          attendanceObj['rollno'] = rollno;
          attendanceObj['month'] = month;
          attendanceObj['subject'] = subject;
          attendanceObj['lecturesAttended'] = lecturesAttended;
          attendanceObj['totalLectures'] = totalLectures;
          attendanceObj['attendancePercent'] = attendancePercent;


          $.ajax({
              type: 'POST',
              url: 'http://localhost:8081/saveAttendance',
              contentType: 'application/json',
              data: JSON.stringify(attendanceObj),
              success: function(data){
                $('#rollnoAttendance').val('');
                $('#months').val('0');
                $('#lecturesAttended').val('');
                $('#totalLectures').val('');
                $('#presentyPercent').val('');
                $('#presentyPercent').attr('style', '');
                getAttendanceList();
                asd();
              },
              error: function(err){
                  alert('Error: '+err);
              }
            })
          }else {
            showAlert("Please fill-in valid values", 'danger');
          }

        }

        $('.calAttendance').blur(function () {
            var lecAttended = $('#lecturesAttended').val();  var totalLectures = $('#totalLectures').val();
            if(lecAttended != 0 && totalLectures !=0){
              var total = lecAttended/totalLectures*100;
              var totalAttendancePerc = Number(total).toFixed(2);

              if(total < 75 && total >= 50){
                $('#presentyPercent').attr('style', 'background-color:yellow;color:black;');
              } else if (total < 50){
                $('#presentyPercent').attr('style', 'background-color:#FF0000; color:white;');
              } else if(total > 75 && total <= 100){
                $('#presentyPercent').attr('style', 'background-color:lightgreen;color:black;');
              }
              $('#presentyPercent').val(totalAttendancePerc+' %');
              $('#presentyPercent').attr('data-value', totalAttendancePerc);
            } else {
              $('#presentyPercent').val(Number(0).toFixed(2)+' %');
              $('#presentyPercent').attr('data-value', Number(0).toFixed(2));
              $('#presentyPercent').attr('style', '');
            }
        })

        function fetchStudentMarksByRollNo(testMarksRemoveId){
          var rollNoTest = $('#rollnotest').val();
          if(rollNoTest==undefined){
            rollNoTest = testMarksRemoveId;
          }
          if(!$.isEmptyObject(rollNoTest) && $.isNumeric(rollNoTest)){
            $.ajax({
              type: 'GET',
              url: 'http://localhost:8081/getStudentMarksByRollNo/'+rollNoTest,
              contentType: 'application/json',
              success: function(dataArr){
                hideSpinnerOverlay();
                $('#marksAddedtbl>tbody').html('');
                dataArr.forEach(jTestData => {
                  var closeBtnHtml = '<button type="button" class="delMrks close" style="float:left;"><i class="fa fa-close" style="color:red; cursor:pointer;"></i></button>';
                  $('#marksAddedtbl>tbody').append('<tr id="'+jTestData.testMarksId+'"><td id="rollNoTest" data-idno="'+jTestData.testMarksId+'">'+jTestData.rollno+'</td><td id="subject">'+jTestData.subject+'</td><td id="test">'+jTestData.test+'</td><td id="marks">'+jTestData.marks+'</td><td>'+closeBtnHtml+'</td></tr>');
                })
                //add remove listerner jquery
                addRemoveTrListener();
              },
              error: function(err){
                hideSpinnerOverlay();
                alert("error " + error);
              }
            })
          }
        }

        function addRemoveTrListener(){
          $('.delMrks').click(function () {
            
              var testMarksRemoveId = $(this).closest('tr').attr('id');
              $.ajax({
                type: 'GET',
                url: 'http://localhost:8081/deleteStudMarksById?testRemoveId='+testMarksRemoveId,
                contentType: 'application/json',
                success: function(data){
                  //fillStudentDetailsTbl(data);
                  fetchStudentMarksByRollNo(testMarksRemoveId);
                },
                error: function(err){
                  alert("error " + error);
                }
              })
          })
        }

        function getAllStudents(){
          showSpinnerOverlay();
          $.ajax({
            type: 'GET',
            url: 'http://localhost:8081/getStudentDetails',
            contentType: 'application/json',
            success: function(data){
              hideSpinnerOverlay();
              if(data.length==0){
                showAlert("No Student records Found", "danger");
              } else {
                fillStudentDetailsTbl(data);
              }
            },
            error: function(err){
              hideSpinnerOverlay();
              alert("error " + error);
            }
          })

        }

        function submitMentor() {
          var mentorName = $('#mentorname').val();
          var rollNos = $('#rollnoForMentorShip').val();

          if(validateSubmitMentorFields(rollNos, mentorName)){
            assignMentorNameToRollNos(rollNos, mentorName);
          } else {
            alert("Please enter valid values");
          }

          function assignMentorNameToRollNos(rollNos, mentorName){
            $.ajax({
              type: 'GET',
              url: 'http://localhost:8081/assignMentorToRollNos?rollNos='+rollNos+"&mentorName="+mentorName,
              contentType: 'application/json',
              success: function(data){
                $('#mentorname').val('');
                $('#rollnoForMentorShip').val('');
                  $('#addMentorModal').modal('hide');
                  showAlert("Mentor has been assigned to specified roll numbers", "success");
                  $("#success-alert2").fadeTo(3000, 500).slideUp(500, function(){
                      $("#success-alert2").slideUp(700);
                    });
                    $('#assignment-title').val('');
                  $('#questionOlList').html('');
                  viewAssignments();
                  
              },
              error: function(err){
                alert("error " + error);
              }
            })
          }


          function validateSubmitMentorFields(rollNos, mentorName){
            var isValid = true;
            const alphanumericRegex = /^[a-zA-Z][a-zA-Z0-9]*$/;
            const alphabetRegex = /^(?!^[,\s]+$)[A-Za-z,\s]+$/; // only alphabets and whitespaces allowed with comma
            const numericRegex = /^[0-9,]+$/g; // accepts numeric with commas

            if(!numericRegex.test(rollNos)){
              isValid = false;
            }
            if(!alphabetRegex.test(mentorName)){
              isValid = false;
            }
            if(rollNos == null || $.isEmptyObject(rollNos)){
              isValid = false;
            }

            if(mentorName == null || $.isEmptyObject(mentorName)){
              isValid = false;
            }
            return isValid;
          }


        }

        function updateAssignmentToNewlyAddedStudents() {
            $.ajax({
            type: "GET",
            dataType: "json",
            url: "http://localhost:8081/updateAssignmentsToNewlyAddedStudents",
            contentType: 'aaplication/json',
            success: function(data) {
                $('#spinnerContainer').addClass('d-none');
              },
              error: function (error) {
                $('#spinnerContainer').addClass('d-none');
                alert("error " + error);
                
              }
            });
        }

        function getAllNotes(page){
          //$('#notesDetailsTbl>tbody').html('');
          showSpinnerOverlay();
          $.ajax({
            type: "GET",
            url: "http://localhost:8081/getAllNotes?page="+page+"&size=10",
            contentType: 'aaplication/json',
            success: function(data) {
                hideSpinnerOverlay();
                if(data.empty==true){
                  showAlert("No Data found","warning");
                }else {
                  populateAllNotesInUITable(data.content);
                  updatePagination(data.totalPages, data.number);
                  $('#spinnerContainer').addClass('d-none');
                }
              },
              error: function (error) {
                //hideLoadingSpinner();
                hideSpinnerOverlay();
                $('#spinnerContainer').addClass('d-none');
                alert("error " + error);
                
              }
            });

            function updatePagination(totalPages, currentPage) {
              let pagination = $("#pagination");
              pagination.empty();
          
              for (let i = 0; i < totalPages; i++) {
                  let li = `<li class="page-item ${i === currentPage ? 'active' : ''}"><a class="page-link" href="#" data-page="${i}">${i + 1}</a></li>`;
                  pagination.append(li);
              }
          
              // Attach click event to the pagination links
              pagination.find("a").on("click", function (e) {
                  
                e.preventDefault();
                  let page = parseInt($(this).data("page"));
                  getAllNotes(page);
              });
          }

            function populateAllNotesInUITable(data) {
              $('#notesDetailsTbl>tbody').html('');
              var cnt=0;
              if(data != null && data.length > 0) {
                data.forEach(e => {
                  var linkEnableDisableHtml =  "<button id='"+e.noteDetailsId+"' class='btn btn-link downloadNoteFileLink' data-code='"+e.code+"' style=' font-weight:500;margin:0; padding:0; text-align:center; vertical-align:middle; text-decoration:none;'><i class='fa fa-download' aria-hidden='true'></i> Download</button>";
                  var closeBtnHtml = '<button type="button" id="'+e.noteDetailsId+'" class="delNote close" style="float:left;"><i class="fa fa-close" style="color:red; cursor:pointer;"></i></button>';
                  $('#notesDetailsTbl>tbody').append('<tr><td>'+(++cnt)+'</td><td>'+e.branch+'</td><td>'+e.semester+'</td><td>'+e.subject+'</td><td>'
                    +e.filename+'</td><td>'+linkEnableDisableHtml+'</td><td>'+closeBtnHtml+'</td></tr>');
                })
              } else {
                $("#success-alert").fadeTo(3000, 500).slideUp(500, function(){
                  $("#success-alert").slideUp(700);
                });
              }

              $('.delNote').click(function () {
                  var deleteNoteId = $(this).attr('id');
                  
                  if($.isEmptyObject(deleteNoteId) || deleteNoteId == undefined){
                    return;
                  }


                  $.ajax({
                    type: 'GET',
                    url: 'http://localhost:8081/deleteNotesById?deleteNoteId='+deleteNoteId,
                    contentType: 'application/json',
                    success: function(data){
                      getAllNotes(0);
                    },
                    error: function(err){
                      alert("error " + error);
                    }
                  })

              });

              $('.downloadNoteFileLink').click(function(){
                
                var fileId = $(this).attr('id');
                const apiUrl = 'http://localhost:8081/getNote/'+fileId;

                fetch(apiUrl, {
                  method: 'GET',
                })
                .then(response => {
                  if (!response.ok) {
                    throw new Error('Network response was not ok.');
                  }
                  return response.json();
                })
                .then(data => {
                  var blobFile = data.fileNotes;
                  const decodedByteArray = decodeBase64ByteArray(blobFile);

                  function decodeBase64ByteArray(base64String) {
                      const binaryString = atob(base64String);
                      const byteArray = new Uint8Array(binaryString.length);
                      for (let i = 0; i < binaryString.length; i++) {
                          byteArray[i] = binaryString.charCodeAt(i);
                      }
                      return byteArray;
                  }

                  // console.log(blobFile);
                  // Uint8Array.from(bData, b => b.charCodeAt(0));
                  // const base64String = btoa(String.fromCharCode(...new BigUint64Array(Uint8Array.from(blobFile, b => b.charCodeAt(0)))));
                  // console.log(base64String);
                  const blob = new Blob([decodedByteArray], {type: 'application/octet-stream'});
                  // var blobFileEx = new Blob([(blobFile)], {type: 'application/pdf'});

                  // Create a download link and set its attributes
                  const downloadLink = document.createElement('a');
                  downloadLink.href = URL.createObjectURL(blob);
                  
                  // Replace 'filename.ext' with the desired name of the downloaded file
                  var originalDateTime = new Date();

                  var modifiedDateTimeStr = formatDate(originalDateTime);
                  function formatDate(dateTime) {
                    var year = dateTime.getFullYear();
                    var month = String(dateTime.getMonth() + 1).padStart(2, '0');
                    var day = String(dateTime.getDate()).padStart(2, '0');
                    var hours = String(dateTime.getHours()).padStart(2, '0');
                    var minutes = String(dateTime.getMinutes()).padStart(2, '0');
                    var seconds = String(dateTime.getSeconds()).padStart(2, '0');

                    // Modify the format as needed (e.g., "YYYY-MM-DD HH:mm:ss")
                    return year + '' + month + '' + day + '' + hours + '' + minutes + '' + seconds;
                  }
                  
                  downloadLink.download = data.filename;

                  // Append the link to the document
                  document.body.appendChild(downloadLink);

                  // Simulate a click on the link to trigger the download
                  downloadLink.click();

                  // Remove the link from the document after the download is triggered
                  document.body.removeChild(downloadLink);
                  
                })
                .catch(error => {
                  alert('Error:', error);
                  $("#my-alert").fadeTo(3000, 500).slideUp(500, function(){
                    $("#my-alert").fadeOut(700);
                  });
                });

              })

            }

        }
        
        function getNotes(){
          // $.ajax({
          //     type: "GET",
          //     url: "http://localhost:8081/getFile",
          //     contentType: 'aaplication/json',
          //     success: function(data) {
          //         console.log(data);
          //     },
          //     error: function (error) {
          //         alert("error " + error);
          //     }
          // });


          const apiUrl = 'http://localhost:8081/getFile';

          fetch(apiUrl, {
            method: 'GET',
          })
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok.');
            }
            return response.blob();
          })
          .then(blob => {
            
            // Create a download link and set its attributes
            const downloadLink = document.createElement('a');
            downloadLink.href = URL.createObjectURL(blob);
            
            // Replace 'filename.ext' with the desired name of the downloaded file
            var originalDateTime = new Date();
            var modifiedDateTimeStr = formatDate(originalDateTime);
            function formatDate(dateTime) {
              var year = dateTime.getFullYear();
              var month = String(dateTime.getMonth() + 1).padStart(2, '0');
              var day = String(dateTime.getDate()).padStart(2, '0');
              var hours = String(dateTime.getHours()).padStart(2, '0');
              var minutes = String(dateTime.getMinutes()).padStart(2, '0');
              var seconds = String(dateTime.getSeconds()).padStart(2, '0');

              // Modify the format as needed (e.g., "YYYY-MM-DD HH:mm:ss")
              return year + '' + month + '' + day + '' + hours + '' + minutes + '' + seconds;
            }

            downloadLink.download = 'filename_'+modifiedDateTimeStr+'.pdf';


            // Append the link to the document
            document.body.appendChild(downloadLink);

            // Simulate a click on the link to trigger the download
            downloadLink.click();

            // Remove the link from the document after the download is triggered
            document.body.removeChild(downloadLink);
          })
          .catch(error => {
            alert('Error:', error);
            $("#my-alert").fadeTo(3000, 500).slideUp(500, function(){
              $("#my-alert").fadeOut(700);
            });
          });











        }

        function performValidation(semTxt,subject) {
          var isValid = true;

          const alphabetRegex = /^(?!^\s+$)[A-Za-z\s]+$/;
          const numericRegex = /^[0-9]+$/;

          if(!alphabetRegex.test(subject)){
            isValid = false;
          }

          if(!numericRegex.test(semTxt) || semTxt > 8 || semTxt < 1){
            isValid = false;
          }
          
          
          if(semTxt == null || $.isEmptyObject(semTxt)){
            isValid = false;
          }

          if(subject == null || $.isEmptyObject(subject)){
            isValid = false;
          }
          return isValid;
        }

        function uploadNotes() {
          var semTxt = $('#semTxt').val();
          var subject = $('#subjectTxt').val();
          const notesFile = document.getElementById('notesFile').files[0];
          
          var fileSize = notesFile.size/1024/1024; //Filesize in MB
          if(fileSize > 10){
            alert('File size limit exceeds! (Max 10MB allowed)');
            return;
          }

          if (!notesFile) {
            alert('Please select a file to upload.');
            return;
          }

          if(performValidation(semTxt,subject)){
            const formData = new FormData();
            formData.append('file', notesFile);
            formData.append('fileext', notesFile.type);
            formData.append('fileName', notesFile.name);
            formData.append('semTxt', semTxt);
            formData.append('subject', subject);
            fetch('http://localhost:8081/uploadNotes', {
              method: 'POST',
              body: formData,
            })
            .then(response => {
              if (response.ok) {
                //alert('File uploaded successfully!');
                $('#myModal2').modal('hide');
                showAlert("File uploaded successfully","success");
                $('#semTxt').val('');
                $('#subjectTxt').val('');
                $('#notesFile').val('');
                getAllNotes(0);

              } else {
                //alert('File upload failed.');
                showAlert("File upload failed.","danger");
              }
            })
            .catch(error => {
              alert('Error:', error);
              $("#my-alert").fadeTo(3000, 500).slideUp(500, function(){
                $("#my-alert").fadeOut(700);
              });
            });
          } else {
              alert("Please enter valid Semester and Subject");
          }
        }

        function updateMarksJson(){
          ;
          var jData = new Object();

          var rollno = $('#rollnotest').val();


          $('#marksAddedtbl>tbody>tr').each(function (i,n) { 
            var jTestData = new Object(); 
            $(n).children().each(function (idx,e) {
              jTestData[$(e).attr('id')] =  $(e).text();
              if(idx==0){
                jTestData['testMarksId'] =  $(e).attr('data-idno');
              }
            });
            if (list.filter(x => x.rollNoTest === jTestData.rollNoTest && x.subject === jTestData.subject && x.test === jTestData.test && x.marks === jTestData.marks).length === 0) { 
              list.push(jTestData);
            }
          })
          
          if(list.length <= 0){
            showAlert("Please add marks first", "danger");
            return;
          }
          jData['marksJson'] = list;
          jData['rollno'] = rollno;
          
          $.ajax({
              type: 'POST',
              url: 'http://localhost:8081/saveStudentMarks',
              contentType: 'application/json',
              data: JSON.stringify(jData),
              success: function(data){
                ;
                list = [];
                  if(data > 0){
                    resetForm();
                    $('#marksAddedtbl>tbody').html('');
                    $("#success-alert1").fadeTo(3000, 500).slideUp(500, function(){
                      $("#success-alert1").slideUp(700);
                    });

                  } else {
                    $("#warning-alert").fadeTo(3000, 500).slideUp(500, function(){
                      $("#warning-alert").slideUp(700);
                    });
                  }
              },
              error: function(err){
                list = [];
                  alert('Error: '+err);
              }
          })
        }
        
        function resetForm(){
          $('#rollnotest').val('');
          $('#subject').val('0');
          $('#test').val('0');
          $('#marks').val('');
        }
        
        function addMarksToJson() {
          var rollNoTest = $('#rollnotest').val();
          
          var subject = $('#subject option:selected').val();

          var test = $('#test option:selected').text();

          var marks = $('#marks').val();

          
          if(validateFields(rollNoTest,subject,test,marks)){
            var jTestData = new Object();

            jTestData.rollNoTest = rollNoTest;
            jTestData.subject = subject;
            jTestData.test = test;
            jTestData.marks = marks;

            addObject(jTestData);

            $('.rmRow').click(function(){
              $(this).closest('tr').remove();
            })
            
          } else {
            showAlert("Please insert valid values", "danger");
          }

          function validateFields(rollNoTest,subject,test,marks){
            var isValid = true;
            if(rollNoTest ==null || rollNoTest ==undefined || rollNoTest==='' || $.isEmptyObject(rollNoTest) || !$.isNumeric(rollNoTest)){
              isValid = false;
              return isValid;
            }
            if(subject ==null || subject ==undefined || subject==='' || subject==='0'){
              isValid = false;
              return isValid;
            }
            if(test ==null || test ==undefined || test==='' || test==='0'){
              isValid = false;
              return isValid;
            }
            if(marks ==null || marks ==undefined || marks==='' || $.isEmptyObject(marks) || !$.isNumeric(marks)){
              isValid = false;
            }
            return isValid;
          }
          
          function addObject(jTestData){

            if (list.filter(x => x.rollNoTest === jTestData.rollNoTest && x.subject === jTestData.subject && x.test === jTestData.test && x.marks === jTestData.marks).length === 0) {
              //list.push(jTestData);
              var closeBtnHtml = '<button type="button" class="rmRow close" style="float:left;"><i class="fa fa-close" style="color:red; cursor:pointer;"></i></button>';
              $('#marksAddedtbl>tbody').append('<tr><td id="rollNoTest">'+jTestData.rollNoTest+'</td><td id="subject">'+jTestData.subject+'</td><td id="test">'+jTestData.test+'</td><td id="marks">'+jTestData.marks+'</td><td>'+closeBtnHtml+'</td></tr>');
            }
            $('.marksAddedJson').html('');
            // $('.marksAddedJson').text(JSON.stringify(list));
            // console.log(JSON.stringify(list));
          }
        }

        function viewAssignments() {
          $('#spinnerContainer').removeClass('d-none');
          // setTimeout(()=> {
            getCall();
          // }
          // ,1500);

          function getCall(){
            $.ajax({
              type: "GET",
              dataType: "json",
              url: "http://localhost:8081/getAssignments",
              contentType: 'aaplication/json',
              success: function(data) {
                  console.log(data);
                  $('#spinnerContainer').addClass('d-none');
                  fillAssignmentsTable(data);
                },
                error: function (error) {
                  $('#spinnerContainer').addClass('d-none');
                  alert("error " + error);
                  
                }
              });
              
            }
        }


        function fillAssignmentsTable(data) {
          $('#viewAssignmentTbl>tbody').html('');
          var questionList = "";
          var submittedAssignmentsStr = "View Submitted Assignments";
          if(data!=null && data != undefined){
            var counter = 0;
            data.forEach(element => {
              if(element != null)  {
                // const myArray = element.assignment.split(",");
                // console.log(myArray);
                // if(element.assignment != null){
                //   const qlist = element.assignment.split(",");
                //   qlist.forEach(function (i,e) {
                //     questionList = questionList + i +"\n";
                //   });
                // }
                if(element.assignmentName !== null && element.assignmentName !==""){
                  $('#viewAssignmentTbl>tbody').append('<tr><td>'+(++counter)+'</td><td>'+element.assignmentName+'</td><td><a href="#" style="text-decoration: none;" class="assignments" id="'+element.assignmentName+'">'+submittedAssignmentsStr+'</a></td> </tr>');
                }
                
                questionList = "";
              }
            });
          } else {
            $("#success-alert").fadeTo(3000, 500).slideUp(500, function(){
              $("#success-alert").slideUp(700);
            });
          }

          $('.assignments').click(function (){
            getStudentSubmittedAssignmentByAssignmentName($(this).attr('id'));
            
          });

        }

        function getStudentSubmittedAssignmentByAssignmentName(assignmentName) {
          showSpinnerOverlay();
          $.ajax({
              type: "GET",
              dataType: "json",
              url: "http://localhost:8081/getAssignmentsDetlsByAssgnName/" + assignmentName,
              contentType: 'aaplication/json',
              success: function(data) {
                hideSpinnerOverlay();
                  fillModalStdntSbmttedAssignmnts(data);
                  fillUpAssignmentCdDropDwn(data);
                  $('#myModal').modal();
              },
              error: function (error) {
                  hideSpinnerOverlay();
                  alert("error " + error);
              }
          });
        }
       
        function fillUpAssignmentCdDropDwn(data){
          var assignmentCodes = new Set();
          if(data != null && data !== undefined){
            data.forEach(e => (e.code !== undefined && e.code != null && e.code!=='')?assignmentCodes.add(e.code): '');
          }
          $('#assignmentCodeDropdwn').html('');
          $('#assignmentCodeDropdwn').append($('<option></option>').attr('value', '0').text('--SELECT--'));
          assignmentCodes.forEach(element => {
            
            var assName = data.filter(e1 => e1.code === element)[0].assignmentName;
            var codeName = assName+" ("+element+")";
            $('#assignmentCodeDropdwn').append($('<option></option>').attr('value', element).text(codeName));
          })
          
          $('#assignmentCodeDropdwn').change(function(){
            var assignmentCode = $('#assignmentCodeDropdwn option:selected').val();
            if(assignmentCode !=undefined && assignmentCode !=null && assignmentCode !=='0'){

              $.ajax({
                type: "GET",
                dataType: "json",
                url: "http://localhost:8081/getAssignmentsDetlsByAssgnCode/" + assignmentCode,
                contentType: 'aaplication/json',
                success: function(data) {
                  fillModalStdntSbmttedAssignmnts(data);
                  // fillUpAssignmentCdDropDwn(data);
                  $('#myModal').modal();
                },
                error: function (error) {
                  alert("error " + error);
                }
              });
            }
          })

        }

        function fillModalStdntSbmttedAssignmnts(data) {
          
          var linkEnableDisableHtml;
          $('#submittedAssignmentsTbl>tbody').html('');
          
          data.forEach(item => {  
            
            if(item.studentSubmittedAssignments !== null && item.studentSubmittedAssignments !="" && item.assignmentStatus == 'SUBMITTED'){
              linkEnableDisableHtml =  "<button type='button' id='"+item.rollno+"' class='btn btn-link studSbmtdFileLink' data-code='"+item.code+"' style='text-decoration: none;'><i class='fa fa-download' aria-hidden='true'></i> Download Submitted Assignment </button>";
            } else {
              linkEnableDisableHtml = "";
            }
            var greenCircleTick = '<i class="fa fa-check-circle" style="font-size:18px; color:#3FD742;"></i>';
            var green = '<i class="fa-regular fa-circle-check fa-sm" style="color: #54d24b;"></i>';
            var redcircleCross = '<i class="fa fa-times-circle" style="font-size:18px; color: #FF0000;"></i>';
            const submittedStatusStr = 'SUBMITTED';
            if(item.rollno != null && item.fullname != null){
              $('#submittedAssignmentsTbl>tbody').append('<tr><td>'+item.rollno+'</td ><td>'+item.fullname+'</td><td>'+item.code+'</td><td class="text-center">'+(item.assignmentStatus===submittedStatusStr?greenCircleTick:redcircleCross)+'</td><td>'+linkEnableDisableHtml+'</td></tr>');
            } 
          });
          
          $('.studSbmtdFileLink').click(function () {
            
              var fileId = $(this).attr('id');
              var assgmntCode = $(this).attr('data-code');
              getStudSbmtdAssignmentFile(fileId,assgmntCode);

          })

          function getStudSbmtdAssignmentFile(fileId,assgmntCode) {
            showSpinnerOverlay();
            var apiUrl = 'http://localhost:8081/getStudSbmtdAssignmentFile/'+fileId+'?assgmntCode='+assgmntCode;
            fetch(apiUrl, {
              method: 'GET',
            })
            .then(response => {
              hideSpinnerOverlay();
              if (!response.ok) {
                throw new Error('Network response was not ok.');
              }
              return response.json();
            })
            .then(data => {
              hideSpinnerOverlay();
              var blobFile = data.studentSubmittedAssignments;
              const decodedByteArray = decodeBase64ByteArray(blobFile);

              function decodeBase64ByteArray(base64String) {
                  const binaryString = atob(base64String);
                  const byteArray = new Uint8Array(binaryString.length);
                  for (let i = 0; i < binaryString.length; i++) {
                      byteArray[i] = binaryString.charCodeAt(i);
                  }
                  return byteArray;
              }

              // console.log(blobFile);
              // Uint8Array.from(bData, b => b.charCodeAt(0));
              // const base64String = btoa(String.fromCharCode(...new BigUint64Array(Uint8Array.from(blobFile, b => b.charCodeAt(0)))));
              // console.log(base64String);
              const blob = new Blob([decodedByteArray], {type: 'application/octet-stream'});
              // var blobFileEx = new Blob([(blobFile)], {type: 'application/pdf'});

              // Create a download link and set its attributes
              const downloadLink = document.createElement('a');
              downloadLink.href = URL.createObjectURL(blob);
              
              // Replace 'filename.ext' with the desired name of the downloaded file
              var originalDateTime = new Date();

              var modifiedDateTimeStr = formatDate(originalDateTime);
              function formatDate(dateTime) {
                var year = dateTime.getFullYear();
                var month = String(dateTime.getMonth() + 1).padStart(2, '0');
                var day = String(dateTime.getDate()).padStart(2, '0');
                var hours = String(dateTime.getHours()).padStart(2, '0');
                var minutes = String(dateTime.getMinutes()).padStart(2, '0');
                var seconds = String(dateTime.getSeconds()).padStart(2, '0');

                // Modify the format as needed (e.g., "YYYY-MM-DD HH:mm:ss")
                return year + '' + month + '' + day + '' + hours + '' + minutes + '' + seconds;
              }
              
              downloadLink.download = 'filename_'+modifiedDateTimeStr+'.'+data.fileExt;

              // Append the link to the document
              document.body.appendChild(downloadLink);

              // Simulate a click on the link to trigger the download
              downloadLink.click();

              // Remove the link from the document after the download is triggered
              document.body.removeChild(downloadLink);
            })
            .catch(error => {
              hideSpinnerOverlay();
              alert('Error:', error);
              $("#my-alert").fadeTo(3000, 500).slideUp(500, function(){
                $("#my-alert").fadeOut(700);
              });
            });

          }

        }

        function submitAssignment() {
          
          var branch = $('#branch').val();
          var semester = $('#semester').val();
          var code = $('#code').val();

          if(validateFields(branch,semester,code)){

            var assignmentObj = new Object();

            var queList = [];

            assignmentObj["assignmentName"] = $('#assignment-title').val();

            $('#questionOlList>li').each(function(i,e) {
              queList.push($(this).text());
            });

            assignmentObj['branch'] = branch;
            assignmentObj['semester'] = semester;
            assignmentObj['code'] = code;
            assignmentObj['queList'] = queList;

            $.ajax({
                type: 'POST',
                url: 'http://localhost:8081/updateAssignment',
                contentType: 'application/json',
                data: JSON.stringify(assignmentObj),
                success: function(data){
                  
                  $('#addAssignmentModal').modal('hide');
                  $('#branch').val('');
                  $('#semester').val('');
                  $('#code').val('');
                  $("#success-alert2").fadeTo(3000, 500).slideUp(500, function(){
                      $("#success-alert2").slideUp(700);
                    });
                    $('#assignment-title').val('');
                  $('#questionOlList').html('');
                  viewAssignments();
                  
                },
                error: function(err){
                    alert('Error: '+err);
                }
            })

          } else {
            alert("Validations Failed");
          }

          function validateFields(branch,semester,code) {
            var isValid = true;
            const alphabetRegex = /^(?!^\s+$)[A-Za-z\s]+$/;
            const numericRegex = /^[0-9]+$/;

            if(!alphabetRegex.test(branch)){
              isValid = false;
              $('#branch').addClass('is-invalid');
              $('#branch').addClass('shake-invalid');
            }else {
              $('#branch').removeClass('is-invalid');
            }

            if(!numericRegex.test(semester)){
              isValid = false;
              $('#semester').addClass('is-invalid');
              $('#semester').addClass('shake-invalid');
            } else {
              $('#semester').removeClass('is-invalid');
            }

            if(branch==null || $.isEmptyObject(branch)){
              isValid = false;
              $('#branch').addClass('is-invalid');
              $('#branch').addClass('shake-invalid');
            }else {
              $('#branch').removeClass('is-invalid');
            }

            if(semester==null || $.isEmptyObject(semester)){
              isValid = false;
              $('#semester').addClass('is-invalid');
              $('#semester').addClass('shake-invalid');
            } else {
              $('#semester').removeClass('is-invalid');
            }
            if(code==null || $.isEmptyObject(code)){
              isValid = false;
              $('#code').addClass('is-invalid');
              $('#code').addClass('shake-invalid');

            } else {
              $('#code').removeClass('is-invalid');
            }
            return isValid;
          }

          

          
        }
        
        function submitAllQuestions () {
          var assignmentObj = new Object();
          assignmentObj["assignmentName"] = $('#assignment-title').val();
          $('#questionOlList>li').each(function(i,e) {
            assignmentObj[i] = $(this).text();
          });
        }

        $('#addAssignmentBtn').click(function addAssignmentQuestion() {
          addQuestion();
          $('.rmItem').click(function(){
            $(this).closest('li').remove();
          })
        })

        function addQuestion() {
          
          var title = $('#assignment-title').val();
          var question = $('#question').val();

          if(title && title != null && isAlphanumericTitle(title) && question && question != null){
            
            $('#questionOlList').append('<li class="m-2 list-group-item">'+question+' <span class="rmItem mx-2"><i class="fa fa-close" style="color:red; cursor:pointer;"></i></span></li>');
            // $('#questionOlList').append('<li>'+question+'</li>');

            
          } else {
            showAlert("Please enter valid details", "warning");
          }

          function isAlphanumericTitle(title){
            var isValid = false;
            const alphanumericRegex = /^[a-zA-Z ][a-zA-Z0-9 ]*$/;
            if(alphanumericRegex.test(title)){
              isValid = true;
            }
            return isValid;
          }

          $('#question').val('');
        }

        

        function getStudentDetails() {
          showSpinnerOverlay();
          var rollno = $('#rollno').val();
          if(rollno !=null && !$.isEmptyObject(rollno) && $.isNumeric(rollno)){
            //valid
            $.ajax({
                type: "GET",
                dataType: "json",
                url: "http://localhost:8081/getStudentDetails/" + rollno,
                contentType: 'aaplication/json',
                success: function(data) {
                    hideSpinnerOverlay();
                    showAlert('Student details found', 'success');
                    fillStudentDetailsTbl(data);
                },
                error: function (error) {
                    hideSpinnerOverlay();
                    showAlert('No student details found!', 'danger');
                }
            });
          } else {
            //validations failed
            hideSpinnerOverlay();
            showAlert('Please enter valid Roll No', 'warning');
          }
        }


        function fillStudentDetailsTbl(dataArr) {
          // console.log(data);
          $('#studentDetailsTbl>tbody').html('');
          dataArr.forEach(data => {
            if(data!=null && data.rollno != null && data.fullname != null && data.semester != null){
              var checkBoxHtml = '<div class="custom-control custom-checkbox"><input class="custom-control-input isLeaderCheckBox" data-rollno='+data.rollno+' type="checkbox" id="customCheck'+data.rollno+'"><label class="custom-control-label" for="customCheck'+data.rollno+'"></label></div>';
            $('#studentDetailsTbl>tbody').append('<tr><td>'+data.rollno+'</td><td>'+data.fullname+'</td><td>'+data.contactno+'</td><td>'+data.enrollmentId+'</td><td>'
              +data.semester+'</td><td>'+data.email+'</td><td>'+data.previousSemResult+'</td><td>'+checkBoxHtml+'</td><td><button data-rollno='+data.rollno+' data-semester='+data.semester+' type="button" class="deleteStudentBySemesterRollno close" style="float:left;"><i class="fa fa-close" style="color:red; cursor:pointer;"></i></button></td></tr>');
            var isChecked = data.isProjectLeader!=null && data.isProjectLeader!=undefined ? data.isProjectLeader : false;
            $('#customCheck'+data.rollno).prop('checked', isChecked);
            } else {
              $("#success-alert").fadeTo(3000, 500).slideUp(500, function(){
                $("#success-alert").slideUp(700);
              });
            }
          })

          $('.isLeaderCheckBox').change(function(){
            var rollno = $(this).attr('data-rollno');
            var isChecked = $(this).is(':checked');
            updateIsPrjectLeaderStatus(rollno, isChecked)
          })



          $('.deleteStudentBySemesterRollno').click(function () {
            cuteAlert({
              type: "question",
              title: "Delete Student Details",
              message: "Confirm delete?",
              confirmText: "Delete",
              cancelText: "Cancel"
            }).then((e)=>{
              if(e === "confirm"){
                //delete studentdetails by Semester and rollno
                var deleteRollNoParam = $(this).attr('data-rollno');
                var deleteSemesterParam = $(this).attr('data-semester');

                $.ajax({
                  type: "GET",
                  url: "http://localhost:8081/deleteStudentBySemesterRollno?semester="+deleteSemesterParam+"&rollno="+deleteRollNoParam,
                  success: function(data) {
                    
                      showAlert('Student details found', 'success');
                      getAllStudents();
                      //fillStudentDetailsTbl(data);
                  },
                  error: function (error) {
                      // alert("error " + error);
                      showAlert('No student details found!', 'danger');
                  }
                });
              } else if("cancel"){
                
              } else {

              }
            })

            



          });
        }


        function updateIsPrjectLeaderStatus(rollno, isChecked){
          var jData = new Object();
          jData['rollno'] = rollno;
          jData['isProjectLeader'] = isChecked;
          showSpinnerOverlay();
          $.ajax({
              type: 'POST',
              url: 'http://localhost:8081/updateIsPrjectLeaderStatus',
              contentType: 'application/json',
              data: JSON.stringify(jData),
              success: function(data){
                hideSpinnerOverlay();
                  showAlert('Project Leader Status has been Updated for rollno: '+rollno, 'success');
              },
              error: function(err){
                hideSpinnerOverlay();
                  showAlert('Project Leader Status Update Failed for rollno: '+rollno, 'danger');
              }
          })
        }

  </script>
